<div class="container">
    <h1>토치라이트 인피니트 MP/HP 봉인 계산기</h1>
    
    <div class="global-settings">
        <h2>전역 설정</h2>
        <div class="form-group">
            <label for="global-bonus">전역 MP 봉인 보상률 (%)</label>
            <input type="number" id="global-bonus" value="0" step="1">
        </div>
        <div class="form-group checkbox-group">
            <input type="checkbox" id="pathfinder-enabled">
            <label for="pathfinder-enabled">개척자의 길 사용</label>
            <span class="custom-tooltip">개척자의 길 사용 시 모든 보조 스킬의 MP 배율이 0.95로 고정됩니다.</span>

        </div>
    </div>

    <div class="skills-container">
        <div class="skill-card" id="skill1">
            <h3>스킬 1</h3>
            <div class="form-group">
                <label for="skill1-name">스킬 이름</label>
                <input type="text" id="skill1-name" placeholder="스킬 이름 입력">
            </div>
            <div class="form-group">
                <label for="skill1-seal">MP 봉인율 (%)</label>
                <select id="skill1-seal">
                    <option value="0">선택하세요</option>
                    <option value="10">10%</option>
                    <option value="15">15%</option>
                    <option value="20">20%</option>
                    <option value="25">25%</option>
                    <option value="30">30%</option>
                    <option value="35">35%</option>
                    <option value="40">40%</option>
                    <option value="45">45%</option>
                    <option value="50">50%</option>
                    <option value="custom">직접 입력</option>
                </select>
                <input type="number" id="skill1-seal-custom" class="custom-input" placeholder="직접 입력" min="0" max="100" step="0.1" style="display: none;">
            </div>
            <div class="form-group">
                <label for="skill1-bonus">개별 MP 봉인 보상률 (%)</label>
                <input type="number" id="skill1-bonus" value="0" step="1">
            </div>
            <div class="form-group auxiliary-skills" id="skill1-auxiliary-container">
                <label>보조 스킬 MP 배율</label>
                <div class="auxiliary-list" id="skill1-auxiliary-list">
                    <!-- 보조 스킬 항목이 여기에 동적으로 추가됩니다 -->
                </div>
                <button type="button" class="add-auxiliary-btn" id="skill1-add-auxiliary">+ 보조 스킬 추가</button>
            </div>
            <div class="form-group checkbox-group">
                <input type="checkbox" id="skill1-hp">
                <label for="skill1-hp">HP 봉인 사용</label>
            </div>
            <div class="form-group hp-modifier" id="skill1-hp-modifier-group" style="display: none;">
                <label for="skill1-hp-modifier">HP 봉인 보정 계수 (%)</label>
                <input type="number" id="skill1-hp-modifier" value="-65" step="1">
                <span class="tooltip">음수(-)는 봉인량 증가, 양수(+)는 봉인량 감소</span>
            </div>
        </div>

        <div class="skill-card" id="skill2">
            <h3>스킬 2</h3>
            <div class="form-group">
                <label for="skill2-name">스킬 이름</label>
                <input type="text" id="skill2-name" placeholder="스킬 이름 입력">
            </div>
            <div class="form-group">
                <label for="skill2-seal">MP 봉인율 (%)</label>
                <select id="skill2-seal">
                    <option value="0">선택하세요</option>
                    <option value="10">10%</option>
                    <option value="15">15%</option>
                    <option value="20">20%</option>
                    <option value="25">25%</option>
                    <option value="30">30%</option>
                    <option value="35">35%</option>
                    <option value="40">40%</option>
                    <option value="45">45%</option>
                    <option value="50">50%</option>
                    <option value="custom">직접 입력</option>
                </select>
                <input type="number" id="skill2-seal-custom" class="custom-input" placeholder="직접 입력" min="0" max="100" step="0.1" style="display: none;">
            </div>
            <div class="form-group">
                <label for="skill2-bonus">개별 MP 봉인 보상률 (%)</label>
                <input type="number" id="skill2-bonus" value="0" step="1">
            </div>
            <div class="form-group auxiliary-skills" id="skill2-auxiliary-container">
                <label>보조 스킬 MP 배율</label>
                <div class="auxiliary-list" id="skill2-auxiliary-list">
                    <!-- 보조 스킬 항목이 여기에 동적으로 추가됩니다 -->
                </div>
                <button type="button" class="add-auxiliary-btn" id="skill2-add-auxiliary">+ 보조 스킬 추가</button>
            </div>
            <div class="form-group checkbox-group">
                <input type="checkbox" id="skill2-hp">
                <label for="skill2-hp">HP 봉인 사용</label>
            </div>
            <div class="form-group hp-modifier" id="skill2-hp-modifier-group" style="display: none;">
                <label for="skill2-hp-modifier">HP 봉인 보정 계수 (%)</label>
                <input type="number" id="skill2-hp-modifier" value="-65" step="1">
                <span class="tooltip">음수(-)는 봉인량 증가, 양수(+)는 봉인량 감소</span>
            </div>
        </div>

        <div class="skill-card" id="skill3">
            <h3>스킬 3</h3>
            <div class="form-group">
                <label for="skill3-name">스킬 이름</label>
                <input type="text" id="skill3-name" placeholder="스킬 이름 입력">
            </div>
            <div class="form-group">
                <label for="skill3-seal">MP 봉인율 (%)</label>
                <select id="skill3-seal">
                    <option value="0">선택하세요</option>
                    <option value="10">10%</option>
                    <option value="15">15%</option>
                    <option value="20">20%</option>
                    <option value="25">25%</option>
                    <option value="30">30%</option>
                    <option value="35">35%</option>
                    <option value="40">40%</option>
                    <option value="45">45%</option>
                    <option value="50">50%</option>
                    <option value="custom">직접 입력</option>
                </select>
                <input type="number" id="skill3-seal-custom" class="custom-input" placeholder="직접 입력" min="0" max="100" step="0.1" style="display: none;">
            </div>
            <div class="form-group">
                <label for="skill3-bonus">개별 MP 봉인 보상률 (%)</label>
                <input type="number" id="skill3-bonus" value="0" step="1">
            </div>
            <div class="form-group auxiliary-skills" id="skill3-auxiliary-container">
                <label>보조 스킬 MP 배율</label>
                <div class="auxiliary-list" id="skill3-auxiliary-list">
                    <!-- 보조 스킬 항목이 여기에 동적으로 추가됩니다 -->
                </div>
                <button type="button" class="add-auxiliary-btn" id="skill3-add-auxiliary">+ 보조 스킬 추가</button>
            </div>
            <div class="form-group checkbox-group">
                <input type="checkbox" id="skill3-hp">
                <label for="skill3-hp">HP 봉인 사용</label>
            </div>
            <div class="form-group hp-modifier" id="skill3-hp-modifier-group" style="display: none;">
                <label for="skill3-hp-modifier">HP 봉인 보정 계수 (%)</label>
                <input type="number" id="skill3-hp-modifier" value="-65" step="1">
                <span class="tooltip">음수(-)는 봉인량 증가, 양수(+)는 봉인량 감소</span>
            </div>
        </div>

        <div class="skill-card" id="skill4">
            <h3>스킬 4</h3>
            <div class="form-group">
                <label for="skill4-name">스킬 이름</label>
                <input type="text" id="skill4-name" placeholder="스킬 이름 입력">
            </div>
            <div class="form-group">
                <label for="skill4-seal">MP 봉인율 (%)</label>
                <select id="skill4-seal">
                    <option value="0">선택하세요</option>
                    <option value="10">10%</option>
                    <option value="15">15%</option>
                    <option value="20">20%</option>
                    <option value="25">25%</option>
                    <option value="30">30%</option>
                    <option value="35">35%</option>
                    <option value="40">40%</option>
                    <option value="45">45%</option>
                    <option value="50">50%</option>
                    <option value="custom">직접 입력</option>
                </select>
                <input type="number" id="skill4-seal-custom" class="custom-input" placeholder="직접 입력" min="0" max="100" step="0.1" style="display: none;">
            </div>
            <div class="form-group">
                <label for="skill4-bonus">개별 MP 봉인 보상률 (%)</label>
                <input type="number" id="skill4-bonus" value="0" step="1">
            </div>
            <div class="form-group auxiliary-skills" id="skill4-auxiliary-container">
                <label>보조 스킬 MP 배율</label>
                <div class="auxiliary-list" id="skill4-auxiliary-list">
                    <!-- 보조 스킬 항목이 여기에 동적으로 추가됩니다 -->
                </div>
                <button type="button" class="add-auxiliary-btn" id="skill4-add-auxiliary">+ 보조 스킬 추가</button>
            </div>
            <div class="form-group checkbox-group">
                <input type="checkbox" id="skill4-hp">
                <label for="skill4-hp">HP 봉인 사용</label>
            </div>
            <div class="form-group hp-modifier" id="skill4-hp-modifier-group" style="display: none;">
                <label for="skill4-hp-modifier">HP 봉인 보정 계수 (%)</label>
                <input type="number" id="skill4-hp-modifier" value="-65" step="1">
                <span class="tooltip">음수(-)는 봉인량 증가, 양수(+)는 봉인량 감소</span>
            </div>
        </div>
    </div>

    <div class="action-buttons">
        <button id="calculate-btn">계산하기</button>
        <button id="reset-btn">초기화</button>
    </div>

    <div class="results" id="results">
        <h2>계산 결과</h2>
        <div class="result-container">
            <!-- MP 봉인 결과 -->
            <div class="result-item">
                <h3>각 스킬별 MP 봉인량</h3>
                <div id="skill-results"></div>
            </div>
            <div class="result-item">
                <h3>총 MP 봉인량</h3>
                <div id="total-seal" class="result-value">0%</div>
            </div>
            <div class="result-item">
                <h3>남은 MP 비율</h3>
                <div id="remaining-mp" class="result-value">100%</div>
            </div>
            
            <!-- HP 봉인 결과 -->
            <div class="result-item" id="hp-results-container" style="display: none;">
                <h3>각 스킬별 HP 봉인량</h3>
                <div id="hp-seal-results"></div>
            </div>
            <div class="result-item" id="hp-total-container" style="display: none;">
                <h3>총 HP 봉인량</h3>
                <div id="total-hp-seal" class="result-value">0%</div>
            </div>
            <div class="result-item" id="hp-remaining-container" style="display: none;">
                <h3>남은 HP 비율</h3>
                <div id="remaining-hp" class="result-value">100%</div>
            </div>
            
            <!-- 활성화 가능 여부 -->
            <div class="result-item">
                <h3>스킬 활성화 가능 여부</h3>
                <div id="activation-status" class="result-value">모든 스킬 활성화 가능</div>
            </div>
        </div>
        
        <div class="calculation-info">
            <h3>계산 방식 안내</h3>
            <p>최종 봉인율 = (기본 봉인 × 보조 MP 배율 누적) ÷ (1 + MP 봉인 보상 합산) ÷ (1 - MP 봉인 보상 추가율)</p>
            <p><strong>계산 단계:</strong></p>
            <p>1. 기준 봉인 계산: 기본 봉인 × 보조 스킬 MP 배율 누적</p>
            <p>2. 봉인 보상 적용: 기준 봉인 ÷ (1 + 봉인 보상 합산)</p>
            <p>3. 봉인 보상 추가 적용: 보상 반영 ÷ (1 - 봉인 보상 추가율)</p>
            <p><strong>항목 설명:</strong></p>
            <p>- 기본 봉인: 스킬 자체 봉인율 (예: 20%)</p>
            <p>- 보조 MP 배율 누적: 개척자 사용 시 0.95 × 0.95 × 0.95 (보조 스킬 개수만큼)</p>
            <p>- MP 봉인 보상 합산: 전역 + 개별 MP 봉인 보상률 (분모에 적용)</p>
            <p>- MP 봉인 보상 추가율: HP 봉인 보정 계수 (음수는 봉인량 증가, 양수는 봉인량 감소)</p>
            <p>- 음수 보정률(-65%)은 (1 - 0.65) = 0.35로 나누어 계산 (봉인량 증가)</p>
            <p class="warning-message">
                ⚠️ <strong>주의:</strong> 본 계산식은 소수점 계산으로 인해 실제 게임 내 표시 수치와 일부 다를 수 있으며, 이는 게임 내 수치 표시 로직의 오류일 수 있습니다.
            </p>
        </div>
    </div>
</div>
